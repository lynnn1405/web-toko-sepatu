<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Risken Shoes - Transaksi</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: #f9fafd;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    header {
      width: 100%;
      max-width: 900px;
      margin-bottom: 30px;
      text-align: center;
      border-bottom: 2px solid #4a90e2;
      padding-bottom: 15px;
    }
    header h1 {
      margin: 0;
      font-weight: 600;
      color: #4a90e2;
    }
    main {
      background: white;
      max-width: 900px;
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      padding: 25px 30px;
      box-sizing: border-box;
    }
    .section-title {
      font-weight: 600;
      color: #4a90e2;
      margin-bottom: 15px;
      border-bottom: 2px solid #4a90e2;
      padding-bottom: 6px;
      font-size: 22px;
    }
    .product-info {
      margin-bottom: 25px;
    }
    .product-item {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 15px;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .product-item img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 5px;
    }
    .product-details {
      flex-grow: 1;
    }
    .product-details h3 {
      margin: 0 0 5px 0;
      font-size: 18px;
    }
    .product-details .price {
      font-size: 16px;
      font-weight: 600;
      color: #222;
    }
    .product-details .quantity {
      font-size: 14px;
      color: #555;
    }
    form {
      margin-bottom: 30px;
    }
    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: #555;
    }
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 20px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
      transition: border-color 0.3s;
      font-family: 'Poppins', sans-serif;
    }
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="tel"]:focus,
    input[type="number"]:focus,
    textarea:focus,
    select:focus {
      border-color: #4a90e2;
      outline: none;
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    .summary {
      background: #f0f6ff;
      border: 1px solid #c7d8ff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      font-size: 18px;
      color: #1a1a1a;
    }
    .summary p {
      margin: 6px 0;
    }
    .total {
      font-weight: 700;
      font-size: 20px;
      margin-top: 15px;
      color: #4a90e2;
    }
    .btn-container {
      text-align: center;
    }
    button.confirm-btn {
      background: #4a90e2;
      color: white;
      font-weight:  --

600;
      font-size: 18px;
      border: none;
      padding: 12px 40px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
      box-shadow: 0 4px 10px rgba(74,144,226,0.5);
    }
    button.confirm-btn:hover {
      background: #205da2;
      box-shadow: 0 6px 15px rgba(32,93,162,0.7);
    }
    #receipt {
      background: #fefefe;
      border: 2px solid #4a90e2;
      border-radius: 12px;
      padding: 20px 25px;
      box-sizing: border-box;
      margin-top: 30px;
      max-width: 900px;
      width: 100%;
      font-family: monospace;
      white-space: pre-wrap;
      color: #222;
      box-shadow: 0 6px 15px rgba(74,144,226,0.15);
      display: none;
    }
    .back-btn {
      margin-top: 20px;
      margin-bottom: 20px;
      margin-left: 0px;
    }
    @media (max-width: 768px) {
      .product-item {
        flex-direction: column;
        align-items: flex-start;
      }
      .product-item img {
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Detail Transaksi - Jaya Shoes</h1>
  </header>

  <button onclick="history.back()" class="back-btn">‚Üê Kembali</button>

  <main>
    <section class="product-info" id="product-list">
      <!-- Daftar produk akan dimuat di sini -->
    </section>

    <section>
      <h3 class="section-title">Data Pembeli</h3>
      <form id="purchase-form">
        <label for="buyer-name">Nama Lengkap</label>
        <input type="text" id="buyer-name" name="buyerName" placeholder="Masukkan nama lengkap" required />

        <label for="buyer-email">Email</label>
        <input type="email" id="buyer-email" name="buyerEmail" placeholder="contoh@mail.com" required />

        <label for="buyer-phone">Nomor Telepon</label>
        <input type="tel" id="buyer-phone" name="buyerPhone" placeholder="0812xxxxxxx" pattern="[0-9]{9,15}" required />

        <label for="buyer-address">Alamat Pengiriman</label>
        <textarea id="buyer-address" name="buyerAddress" placeholder="Masukkan alamat lengkap" required></textarea>

        <label for="payment-method">Metode Pembayaran</label>
        <select id="payment-method" name="paymentMethod" required>
          <option value="" disabled selected>Pilih metode pembayaran</option>
          <option value="BRI">BRI</option>
          <option value="BSI">BSI</option>
          <option value="BNI">BNI</option>
          <option value="BCA">BCA</option>
          <option value="Mandiri">Mandiri</option>
          <option value="OVO">OVO</option>
          <option value="GoPay">GoPay</option>
          <option value="ShopeePay">ShopeePay</option>
          <option value="Dana">Dana</option>
        </select>

        <label for="shipping-method">Metode Pengiriman</label>
        <select id="shipping-method" name="shippingMethod" required>
          <option value="" disabled selected>Pilih metode pengiriman</option>
          <option value="JNT">JNT</option>
          <option value="JNE">JNE</option>
          <option value="Gojek">Gojek</option>
          <option value="SiCepat Express">SiCepat Express</option>
        </select>

        <div class="summary">
          <p>Subtotal: <span id="subtotal">Rp 0</span></p>
          <p>Ongkos Kirim: <span id="shipping-cost">Rp 0</span></p>
          <p class="total">Total: <span id="total-price">Rp 0</span></p>
        </div>

        <div class="btn-container">
          <button type="submit" class="confirm-btn">Konfirmasi Pembelian</button>
        </div>
      </form>

      <pre id="receipt"></pre>
    </section>
  </main>

</body>
</html>

  <script>
    // Fungsi format angka jadi Rupiah
    function formatRupiah(num) {
      return 'Rp ' + num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    // Fungsi untuk menampilkan item yang dipilih
    function displaySelectedItems() {
      const productList = document.getElementById('product-list');
      const subtotalElement = document.getElementById('subtotal');
      const shippingElement = document.getElementById('shipping-cost');
      const totalElement = document.getElementById('total-price');

      // Ambil data dari localStorage
      const selectedItems = JSON.parse(localStorage.getItem('selectedItems')) || [];

      // Jika tidak ada item yang dipilih, tampilkan pesan
      if (selectedItems.length === 0) {
        productList.innerHTML = '<p>Tidak ada produk yang dipilih.</p>';
        subtotalElement.textContent = formatRupiah(0);
        shippingElement.textContent = formatRupiah(0);
        totalElement.textContent = formatRupiah(0);
        return;
      }

      // Tampilkan setiap item
      productList.innerHTML = '';
      let subtotal = 0;

      selectedItems.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.classList.add('product-item');
        itemElement.innerHTML = `
          <img src="${item.image}" alt="${item.name}">
          <div class="product-details">
            <h3>${item.name}</h3>
            <p class="price">${formatRupiah(item.price)}</p>
            <p class="quantity">Jumlah: ${item.quantity}</p>
          </div>
        `;
        productList.appendChild(itemElement);
        subtotal += item.price * item.quantity;
      });

      // Hitung ongkos kirim (misalnya Rp 20.000 jika ada item)
      const shippingCost = selectedItems.length > 0 ? 20000 : 0;
      const totalPrice = subtotal + shippingCost;

      // Perbarui ringkasan
      subtotalElement.textContent = formatRupiah(subtotal);
      shippingElement.textContent = formatRupiah(shippingCost);
      totalElement.textContent = formatRupiah(totalPrice);
    }

    // Tangani submit form
    document.getElementById('purchase-form').addEventListener('submit', function(e) {
      e.preventDefault();

      const buyerName = document.getElementById('buyer-name').value.trim();
      const buyerEmail = document.getElementById('buyer-email').value.trim();
      const buyerPhone = document.getElementById('buyer-phone').value.trim();
      const buyerAddress = document.getElementById('buyer-address').value.trim();
      const paymentMethod = document.getElementById('payment-method').value;
      const shippingMethod = document.getElementById('shipping-method').value;

      if (!buyerName || !buyerEmail || !buyerPhone || !buyerAddress || !paymentMethod || !shippingMethod) {
        alert('Mohon lengkapi semua data pembeli, metode pembayaran, dan metode pengiriman.');
        return;
      }

      // Ambil item yang dipilih
      const selectedItems = JSON.parse(localStorage.getItem('selectedItems')) || [];
      if (selectedItems.length === 0) {
        alert('Tidak ada produk yang dipilih.');
        return;
      }

      // Buat isi struk
      let itemsText = '';
      let subtotal = 0;
      selectedItems.forEach(item => {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;
        itemsText += `${item.name}\n`;
        itemsText += `  Harga per item: ${formatRupiah(item.price)}\n`;
        itemsText += `  Jumlah: ${item.quantity}\n`;
        itemsText += `  Total: ${formatRupiah(itemTotal)}\n\n`;
      });

      const shippingCost = selectedItems.length > 0 ? 20000 : 0;
      const totalPrice = subtotal + shippingCost;

      const receiptText = `--- STRUK PEMBELIAN ---
    Nama Pembeli     : ${buyerName}
    Email            : ${buyerEmail}
    No. Telepon      : ${buyerPhone}
    Alamat           : ${buyerAddress}

    Produk:
    ${itemsText}Subtotal        : ${formatRupiah(subtotal)}
    Ongkos Kirim     : ${formatRupiah(shippingCost)}
    Total Harga      : ${formatRupiah(totalPrice)}

    Metode Pembayaran: ${paymentMethod}
    Metode Pengiriman: ${shippingMethod}

    Terima kasih telah membeli di Jaya Shoes!
    -----------------------`;

      // Tampilkan struk
      const receiptEl = document.getElementById('receipt');
      receiptEl.textContent = receiptText;
      receiptEl.style.display = 'block';

      // Scroll ke struk
      receiptEl.scrollIntoView({ behavior: 'smooth' });

      // Kosongkan keranjang setelah transaksi berhasil
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      selectedItems.forEach(selected => {
        cart = cart.filter(item => item.id !== selected.id);
      });
      localStorage.setItem('cart', JSON.stringify(cart));
      localStorage.removeItem('selectedItems');

      // Perbarui badge keranjang
      updateCartBadge();
    });

    // Jalankan saat halaman dimuat
    document.addEventListener('DOMContentLoaded', () => {
      displaySelectedItems();
    });
        
  </script>

</body>
</html>
